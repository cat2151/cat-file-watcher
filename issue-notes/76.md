# issue tomlにて、filesセクションとほぼ同様の、commandsセクションと、processesセクションを書けるようにする #76
[issues #76](https://github.com/cat2151/cat-file-watcher/issues/76)

## 実装内容

### 概要

TOML設定ファイルに新しい`[[commands]]`と`[[processes]]`セクションを追加しました。これらは`[[files]]`セクションとほぼ同様の機能を持つシンタックスシュガーで、ユーザーの認知負荷を下げることを目的としています。

### 主な機能

1. **[[commands]]セクション**: 定期的なコマンド実行用のセクション
   - `path`フィールドは禁止（指定するとエラー）
   - 内部的には`path=""`として`[[files]]`セクションにマージされる
   - コマンドの定期実行であることが明確になる

2. **[[processes]]セクション**: プロセス監視/終了用のセクション
   - `path`フィールドは禁止（指定するとエラー）
   - `command`フィールドは禁止（指定するとエラー）
   - 主に`terminate_if_process`機能で使用
   - プロセス関連のタスクであることが明確になる

3. **バリデーション**:
   - `[[files]]`: `path`が必須
   - `[[commands]]`: `path`が禁止
   - `[[processes]]`: `path`と`command`が禁止

### 変更箇所

#### src/config_loader.py
- `load_config()`: `[[commands]]`と`[[processes]]`セクションのバリデーションとマージ処理を追加
- `_validate_commands_format()`: 新規メソッド - `[[commands]]`セクションのバリデーション
- `_validate_processes_format()`: 新規メソッド - `[[processes]]`セクションのバリデーション
- `_merge_sections()`: 新規メソッド - `[[commands]]`と`[[processes]]`を`[[files]]`にマージ
- `_merge_external_files()`: 外部ファイルで3つのセクションすべてをサポートするように更新

#### src/cat_file_watcher.py
- `_calculate_main_loop_interval()`: `[[commands]]`と`[[processes]]`セクションのインターバルも考慮するように更新

#### tests/test_commands_and_processes_sections.py
- 新規テストファイル作成
- 15個の包括的なテストケースを実装:
  - `[[commands]]`セクションの基本機能
  - `[[commands]]`セクションの複数エントリ
  - `[[commands]]`セクションでのpath禁止バリデーション
  - `[[commands]]`セクションでのsuppress_if_process使用
  - `[[commands]]`セクションのコマンド実行
  - `[[processes]]`セクションの基本機能
  - `[[processes]]`セクションでのpath禁止バリデーション
  - `[[processes]]`セクションでのcommand禁止バリデーション
  - `[[processes]]`セクションの複数エントリ
  - 3つのセクションの混在
  - 外部ファイルでの`[[commands]]`セクション使用
  - 外部ファイルでの`[[processes]]`セクション使用
  - バリデーション順序の検証
  - 配列形式のバリデーション

#### tests/test_cat_file_watcher.py
- `test_load_config()`: 配列形式の`[[files]]`セクションに対応するように更新

#### examples/config.example.toml
- `[[commands]]`セクションの使用例を追加（例24-27）
- `[[processes]]`セクションの使用例を追加（例28-30）

#### examples/monitoring-group-example.toml
- `[[commands]]`セクションの例を追加
- `[[processes]]`セクションの例を追加
- 外部ファイルで3つのセクションすべてが使用可能であることを示す

### 使用例

#### [[commands]]セクション
```toml
# 定期的なコマンド実行（ファイル監視なし）
[[commands]]
command = "python cleanup.py"
interval = "1h"

[[commands]]
command = "./backup.sh"
suppress_if_process = "backup"
interval = "30m"
```

#### [[processes]]セクション
```toml
# プロセス監視と終了
[[processes]]
terminate_if_process = "unwanted_process"
interval = "5m"

[[processes]]
terminate_if_process = "rogue_app"
time_period = "night_shift"
interval = "1m"
```

#### 混在使用
```toml
# ファイル監視
[[files]]
path = "config.json"
command = "validate_config.sh"

# 定期コマンド
[[commands]]
command = "cleanup.sh"
interval = "1h"

# プロセス監視
[[processes]]
terminate_if_process = "memory_hog"
interval = "5m"
```

### テスト結果

すべてのテスト（153個）が成功しました:
- 新規追加: 15テスト（すべて成功）
- 既存テスト: 138テスト（修正1件含む）

### 手動検証

1. **基本機能**: 3つのセクションすべてが正しくロードされ、マージされることを確認
2. **バリデーション**: 
   - `[[commands]]`で`path`指定時にエラーになることを確認
   - `[[processes]]`で`path`指定時にエラーになることを確認
   - `[[processes]]`で`command`指定時にエラーになることを確認
3. **外部ファイル**: 外部ファイルで3つのセクションすべてが使用できることを確認
4. **マージ結果**: すべてのセクションが正しく`[[files]]`にマージされ、適切な`path`値が設定されることを確認

### 結論

- ✅ `[[commands]]`と`[[processes]]`セクションの実装が完了
- ✅ 適切なバリデーションが実装され、エラーケースが検出される
- ✅ 外部ファイルで3つのセクションすべてがサポートされる
- ✅ 既存機能への影響なし
- ✅ 包括的なテストカバレッジ
- ✅ ドキュメントと例が更新済み
