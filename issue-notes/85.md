# issue issue #71 の原因を調査する #85
[issues #85](https://github.com/cat2151/cat-file-watcher/issues/85)

## 調査結果

詳細な調査報告書を作成しました: [71-investigation-report.md](./71-investigation-report.md)

## 概要

Issue #71（agentによるPRに対してRuffの実行が自動承認されず、手動承認が必要）の根本原因を調査しました。

### 主な発見事項

1. **根本原因**: `pull_request_target`トリガーの使用により、GitHub Copilot等のbotも「first-time contributor」として扱われ、セキュリティポリシー上、手動承認が必須となる。

2. **セキュリティリスク**: 現在のワークフロー実装には、`pull_request_target`で信頼できないコードをチェックアウト・実行する重大なセキュリティ脆弱性（PWN Request攻撃に対する脆弱性）が存在する。

3. **仕様上の制限**: GitHubの設計思想として、この承認要求を完全に回避する方法は存在しない。

4. **推奨事項**: 現在の手動承認プロセスは、セキュリティ脆弱性に対する重要な防御層であるため、**維持することを推奨**。

### 参照した技術記事（一部）

- [Keeping your GitHub Actions and workflows secure: Preventing pwn requests](https://securitylab.github.com/resources/github-actions-preventing-pwn-requests/)
- [GitHub Actions Security Best Practices](https://blog.gitguardian.com/github-actions-security-cheat-sheet/)
- [pull_request_target Misconfiguration Leads to RCE](https://orca.security/resources/blog/pull-request-nightmare-github-actions-rce/)
- [Approving workflow runs from forks - GitHub Docs](https://docs.github.com/en/actions/how-tos/manage-workflow-runs/approve-runs-from-forks)

完全な参考文献リストと詳細な技術解説は、[調査報告書](./71-investigation-report.md)を参照してください。

## 結論

Issue #71の問題は、GitHubのセキュリティ仕様に起因するものであり、修正ではなく「仕様として受け入れる」ことが適切です。手動承認プロセスは、セキュリティを維持するために必要不可欠です。
