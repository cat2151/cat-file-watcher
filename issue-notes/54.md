# issue tomlにおけるintervalの単位を、ミリ秒でなく、1s（1秒）、2m（2分）、3h（3時間）に仕様変更する #54
[issues #54](https://github.com/cat2151/cat-file-watcher/issues/54)

## 結論 / Conclusion

TOMLファイルのintervalの単位を、従来のミリ秒（整数値）から、時間フォーマット文字列（"1s", "2m", "3h", "0.5s"）に変更しました。

Changed the interval unit in TOML files from milliseconds (integer) to time format strings ("1s", "2m", "3h", "0.5s").

## 実装内容 / Implementation

1. **新しいモジュール**: `src/interval_parser.py`
   - 時間フォーマット文字列のパース機能
   - 小数点サポート（"0.5s", "1.5m", "0.25h"）
   - 後方互換性のため、旧フォーマット（ミリ秒の整数値）もサポート

2. **更新したモジュール**:
   - `src/config_loader.py`: IntervalParserを使用してintervalを解析
   - `src/cat_file_watcher.py`: 各所でIntervalParserを使用

3. **新しい時間フォーマット**:
   - 秒: "1s", "2s", "0.5s", ".5s"
   - 分: "1m", "2m", "1.5m"
   - 時: "1h", "3h", "0.5h"

4. **後方互換性**:
   - 旧フォーマット（整数のミリ秒値）も引き続きサポート
   - 既存の設定ファイルは変更なしで動作

## テスト / Tests

新しいテスト:
- `tests/test_interval_parser.py`: IntervalParserクラスの単体テスト（9テスト）
- `tests/test_new_interval_format.py`: 新フォーマットの統合テスト（11テスト）

既存テスト: 110テスト（すべて成功）
新規テスト: 20テスト（すべて成功）
合計: 130テスト（すべて成功）

## ドキュメント更新 / Documentation Updates

1. **examples/config.example.toml**: すべてのintervalを新フォーマットに更新
2. **examples/monitoring-group-example.toml**: 新フォーマットに更新
3. **README.ja.md**: 
   - interval設定の説明を更新
   - 小数点サポート（"0.5s"）を明記
   - 後方互換性について記載
4. **README.md**:
   - interval設定の説明を更新（英語）
   - 小数点サポート（"0.5s"）を明記
   - 後方互換性について記載

## 使用例 / Usage Examples

```toml
# デフォルト間隔（新フォーマット）
default_interval = "1s"
config_check_interval = "2s"

[files]
"test.txt" = { command = "echo test", interval = "3s" }
"data.csv" = { command = "process.sh", interval = "5m" }
"log.txt" = { command = "backup.sh", interval = "1h" }
"fast.txt" = { command = "quick.sh", interval = "0.5s" }

# 旧フォーマット（後方互換性）
"legacy.txt" = { command = "old.sh", interval = 1000 }
```
