# issue 単体テストフレームワークを、unittestから、モダンなpytestに移行する #37
[issues #37](https://github.com/cat2151/cat-file-watcher/issues/37)

## 概要 / Summary

unittestベースのテストフレームワークを、モダンなpytestに移行しました。

Migrated the test framework from unittest to modern pytest.

## 実装内容 / Implementation

### 1. **依存関係の追加** / Dependencies Added
- `requirements.txt`に`pytest>=8.0.0`を追加
- Added `pytest>=8.0.0` to requirements.txt

### 2. **pytest設定ファイル** / pytest Configuration
- `pytest.ini`を新規作成
- 設定内容：
  - テストパス: `tests/`
  - テストファイルパターン: `test_*.py`
  - 詳細出力: `-v`オプション
- Created `pytest.ini` with configuration for test paths and verbose output

### 3. **テストファイルの移行** / Test File Migration

すべての13個のテストファイルを移行：
Migrated all 13 test files:

- `test_basics.py`
- `test_cat_file_watcher.py`
- `test_command_logging.py`
- `test_command_suppression.py`
- `test_config_reload.py`
- `test_empty_filename.py`
- `test_error_logging.py`
- `test_external_files.py`
- `test_interval_division.py`
- `test_intervals.py`
- `test_process_detection.py`
- `test_suppression_logging.py`
- `test_time_periods.py`

### 4. **主な変更点** / Main Changes

#### クラス定義 / Class Definition
```python
# 変更前 / Before
class TestSomething(unittest.TestCase):

# 変更後 / After
class TestSomething:
```

#### セットアップ・ティアダウン / Setup and Teardown
```python
# 変更前 / Before
def setUp(self):
def tearDown(self):

# 変更後 / After
def setup_method(self):
def teardown_method(self):
```

#### アサーション / Assertions
```python
# 変更前 / Before
self.assertEqual(a, b)
self.assertNotEqual(a, b)
self.assertTrue(x)
self.assertFalse(x)
self.assertIsNone(x)
self.assertIsNotNone(x)
self.assertIn(a, b)
self.assertNotIn(a, b)
self.assertIsInstance(x, type)
self.assertGreater(a, b)
self.assertLess(a, b)

# 変更後 / After
assert a == b
assert a != b
assert x
assert not x
assert x is None
assert x is not None
assert a in b
assert a not in b
assert isinstance(x, type)
assert a > b
assert a < b
```

#### 例外処理 / Exception Handling
```python
# 変更前 / Before
with self.assertRaises(Exception) as cm:
    some_function()
assert cm.exception.code == 1

# 変更後 / After
import pytest
with pytest.raises(Exception) as cm:
    some_function()
assert cm.value.code == 1
```

#### インポート / Imports
```python
# 変更前 / Before
import unittest

# 変更後 / After
import pytest  # 例外テストがある場合のみ
import shutil  # teardownで使用
```

#### エントリーポイント / Entry Point
```python
# 変更前 / Before
if __name__ == '__main__':
    unittest.main()

# 変更後 / After
# (削除 / Removed)
```

## テスト結果 / Test Results

- 全テスト数: 93個
- 成功: 93個
- 失敗: 0個

- Total tests: 93
- Passed: 93
- Failed: 0

すべてのテストが正常に動作することを確認しました。

All tests pass successfully with pytest.

## 実行方法 / How to Run

```bash
# pytest実行
pytest tests/ -v

# 特定のファイルのみ
pytest tests/test_basics.py -v

# 特定のテストのみ
pytest tests/test_basics.py::TestFileWatcherBasics::test_load_config -v
```

## 変更しなかった点 / What Was Not Changed

- テストロジック自体は変更していません（アサーション方式のみ変更）
- `sys.path.insert(0, ...)`によるモジュールインポート方式は維持
- テストディレクトリ構造は維持

- Test logic itself was not changed (only assertion style)
- Module import method using `sys.path.insert(0, ...)` was preserved
- Test directory structure was preserved

## 利点 / Benefits

1. **より読みやすいテストコード**
   - シンプルな`assert`文の使用
   - Less verbose test code with simple assertions

2. **より良いエラーメッセージ**
   - pytestは失敗時により詳細な情報を提供
   - pytest provides more detailed failure messages

3. **モダンな機能へのアクセス**
   - フィクスチャ、パラメータ化テストなど、将来の拡張が容易
   - Access to modern features like fixtures, parametrized tests for future enhancements

4. **コミュニティの標準**
   - Pythonコミュニティで広く使用されているテストフレームワーク
   - Widely used testing framework in the Python community

## 互換性 / Compatibility

- Python 3.6以上で動作
- 既存のCI/CDパイプラインは、`python -m unittest`を`pytest`に置き換えるだけで対応可能
- Works with Python 3.6+
- Existing CI/CD pipelines can be updated by replacing `python -m unittest` with `pytest`

